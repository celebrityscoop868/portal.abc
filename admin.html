<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>SunPower Admin Portal | Employee Management</title>
    <link rel="stylesheet" href="./assets/app.css"/>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: system-ui, -apple-system, sans-serif; background: #f3f4f6; }
        
        .admin-header {
            background: linear-gradient(180deg, #0d47a1, #1565c0);
            color: white;
            padding: 20px;
        }
        
        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo { font-size: 20px; font-weight: 700; display: flex; align-items: center; gap: 10px; }
        .logo::before { content: "‚òÄÔ∏è"; }
        
        .logout-btn {
            background: rgba(255,255,255,0.2);
            border: 1px solid white;
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
        }
        
        .employee-selector {
            background: white;
            padding: 16px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .selector-label { font-weight: 600; color: #374151; }
        .selector-input {
            padding: 10px 14px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
            width: 150px;
            text-transform: uppercase;
        }
        .selector-btn {
            padding: 10px 20px;
            background: #1565c0;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }
        .current-emp {
            margin-left: auto;
            padding: 8px 16px;
            background: #f3f4f6;
            border-radius: 20px;
            font-size: 14px;
            color: #6b7280;
        }
        .current-emp.active {
            background: #dbeafe;
            color: #1565c0;
            font-weight: 600;
        }
        
        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .tab {
            padding: 12px 20px;
            background: white;
            border: none;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: #6b7280;
            border-bottom: 3px solid transparent;
        }
        
        .tab.active {
            color: #1565c0;
            border-bottom-color: #1565c0;
            background: white;
        }
        
        .content-section {
            display: none;
            background: white;
            padding: 24px;
            border-radius: 0 8px 8px 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .content-section.active { display: block; }
        
        .card {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .card-title {
            font-size: 18px;
            font-weight: 700;
            color: #111827;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 2px solid #f3f4f6;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 16px;
        }
        
        .form-group { display: flex; flex-direction: column; }
        .form-label {
            font-size: 12px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 6px;
            text-transform: uppercase;
        }
        .form-input, .form-select {
            padding: 10px 14px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
        }
        .form-textarea {
            padding: 10px 14px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
            min-height: 80px;
            resize: vertical;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .btn-primary { background: #1565c0; color: white; }
        .btn-success { background: #059669; color: white; }
        .btn-danger { background: #dc2626; color: white; }
        .btn-secondary { background: #6b7280; color: white; }
        
        .alert {
            padding: 12px 16px;
            border-radius: 6px;
            margin-bottom: 16px;
            font-size: 14px;
        }
        .alert-info { background: #dbeafe; color: #1e40af; }
        .alert-success { background: #d1fae5; color: #065f46; }
        .alert-warning { background: #fef3c7; color: #92400e; }
        .alert-error { background: #fee2e2; color: #991b1b; }
        
        .employee-list { display: flex; flex-direction: column; gap: 12px; }
        .employee-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px;
            background: #f9fafb;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }
        .employee-info { flex: 1; }
        .employee-id { font-weight: 700; color: #1565c0; font-size: 16px; }
        .employee-name { color: #374151; margin-top: 4px; }
        .employee-email { font-size: 13px; color: #6b7280; margin-top: 2px; }
        .employee-actions { display: flex; gap: 8px; align-items: center; }
        
        .status-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        .status-active { background: #d1fae5; color: #065f46; }
        .status-inactive { background: #fee2e2; color: #991b1b; }
        .status-pending { background: #fef3c7; color: #92400e; }
        .status-verified { background: #dbeafe; color: #1e40af; }
        
        .step-list { display: flex; flex-direction: column; gap: 12px; }
        .step-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: #f9fafb;
            border-radius: 6px;
        }
        .step-item.completed { background: #d1fae5; }
        .step-checkbox { width: 20px; height: 20px; }
        .step-label { flex: 1; font-weight: 500; }
        .step-status { font-size: 18px; }
        
        .chat-container {
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            overflow: hidden;
        }
        .chat-header {
            background: #f3f4f6;
            padding: 12px 16px;
            font-weight: 600;
            color: #374151;
        }
        .chat-messages {
            height: 300px;
            overflow-y: auto;
            padding: 16px;
            background: white;
        }
        .chat-input-area {
            display: flex;
            padding: 12px;
            background: #f9fafb;
            border-top: 1px solid #e5e7eb;
        }
        .chat-input {
            flex: 1;
            padding: 10px 14px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            margin-right: 8px;
        }
        
        .message {
            margin-bottom: 12px;
            max-width: 70%;
            padding: 10px 14px;
            border-radius: 12px;
            font-size: 14px;
        }
        .message.admin {
            background: #1565c0;
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 4px;
        }
        .message.employee {
            background: #f3f4f6;
            color: #374151;
            border-bottom-left-radius: 4px;
        }
        .message-time {
            font-size: 11px;
            opacity: 0.7;
            margin-top: 4px;
        }
        
        .id-pool-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 8px;
            max-height: 300px;
            overflow-y: auto;
        }
        .id-item {
            padding: 8px;
            text-align: center;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 600;
        }
        .id-available { background: #d1fae5; color: #065f46; }
        .id-assigned { background: #fee2e2; color: #991b1b; }
        .id-verified { background: #dbeafe; color: #1e40af; }
        
        .empty-state {
            text-align: center;
            padding: 40px;
            color: #9ca3af;
        }
        
        .toast-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
        .toast {
            padding: 12px 20px;
            border-radius: 6px;
            margin-top: 8px;
            color: white;
            font-weight: 500;
            animation: slideIn 0.3s ease;
        }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .toast.success { background: #059669; }
        .toast.error { background: #dc2626; }
        .toast.info { background: #1565c0; }
    </style>
</head>
<body>

<div class="admin-header">
    <div class="header-content">
        <div class="logo">SunPower Admin Portal</div>
        <button class="logout-btn" id="btnLogout">Log Out</button>
    </div>
</div>

<div class="container">
    <!-- Employee Selector -->
    <div class="employee-selector">
        <span class="selector-label">üéØ CURRENT EMPLOYEE:</span>
        <input type="text" class="selector-input" id="currentEmpId" placeholder="SP001" style="text-transform: uppercase;">
        <button class="selector-btn" id="btnLoadEmp">Load Employee</button>
        <div class="current-emp" id="currentEmpBadge">None selected</div>
    </div>

    <!-- Tabs -->
    <div class="tabs">
        <button class="tab active" data-tab="employees">üë• Employees</button>
        <button class="tab" data-tab="onboarding">üìã Onboarding</button>
        <button class="tab" data-tab="appointment">üìÖ Appointment</button>
        <button class="tab" data-tab="shift">üïê Shift</button>
        <button class="tab" data-tab="chat">üí¨ Chat</button>
        <button class="tab" data-tab="ids">üÜî ID Pool</button>
    </div>

    <!-- Employees Tab -->
    <div id="tab-employees" class="content-section active">
        <div class="card">
            <div class="card-title">Create New Employee</div>
            <div class="alert alert-info">
                <strong>Flow:</strong> Admin creates employee ‚Üí System sends ID to employee ‚Üí Employee verifies with Google Sign In
            </div>
            <div class="form-grid">
                <div class="form-group">
                    <label class="form-label">Employee ID *</label>
                    <input type="text" class="form-input" id="newEmpId" placeholder="SP001" style="text-transform: uppercase;">
                </div>
                <div class="form-group">
                    <label class="form-label">Full Name *</label>
                    <input type="text" class="form-input" id="newEmpName" placeholder="John Smith">
                </div>
                <div class="form-group">
                    <label class="form-label">Email *</label>
                    <input type="email" class="form-input" id="newEmpEmail" placeholder="employee@email.com">
                </div>
                <div class="form-group" style="display: flex; align-items: flex-end;">
                    <button class="btn btn-success" id="btnCreateEmployee" style="width: 100%;">
                        ‚ûï Create Employee
                    </button>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-title">All Employees</div>
            <div id="employeesList">
                <div class="empty-state">Loading employees...</div>
            </div>
        </div>
    </div>

    <!-- Onboarding Tab -->
    <div id="tab-onboarding" class="content-section">
        <div class="card">
            <div class="card-title">Onboarding Progress</div>
            <div id="onboardingStatus">
                <div class="alert alert-warning">Load an employee to view progress</div>
            </div>
        </div>
        
        <div class="card">
            <div class="card-title">Manual Step Control</div>
            <div class="form-grid">
                <div class="form-group">
                    <label class="form-label">Step to Update</label>
                    <select class="form-select" id="stepSelect">
                        <option value="0">1. Shift Selection</option>
                        <option value="1">2. Safety Footwear</option>
                        <option value="2">3. I-9 Verification</option>
                        <option value="3">4. Photo Badge</option>
                        <option value="4">5. First Day Prep</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Action</label>
                    <select class="form-select" id="stepAction">
                        <option value="complete">Mark Complete</option>
                        <option value="reset">Reset Step</option>
                    </select>
                </div>
                <div class="form-group" style="display: flex; align-items: flex-end;">
                    <button class="btn btn-primary" id="btnUpdateStep" style="width: 100%;">Update Step</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Appointment Tab -->
    <div id="tab-appointment" class="content-section">
        <div class="card">
            <div class="card-title">First Day Appointment</div>
            <div class="form-grid">
                <div class="form-group">
                    <label class="form-label">Date</label>
                    <input type="date" class="form-input" id="apptDate">
                </div>
                <div class="form-group">
                    <label class="form-label">Time</label>
                    <input type="time" class="form-input" id="apptTime">
                </div>
                <div class="form-group" style="grid-column: span 2;">
                    <label class="form-label">Location / Address</label>
                    <input type="text" class="form-input" id="apptLocation" placeholder="1234 Industrial Blvd, Louisville, KY">
                </div>
                <div class="form-group" style="grid-column: span 2;">
                    <label class="form-label">Instructions</label>
                    <textarea class="form-textarea" id="apptNotes" placeholder="Parking info, what to bring, dress code..."></textarea>
                </div>
            </div>
            <div style="margin-top: 16px; display: flex; gap: 12px;">
                <button class="btn btn-primary" id="btnSaveAppt">üíæ Save Appointment</button>
                <button class="btn btn-secondary" id="btnClearAppt">Clear</button>
            </div>
            <div class="alert alert-success" id="apptSuccess" style="display: none; margin-top: 16px;">
                ‚úÖ Appointment saved successfully!
            </div>
        </div>
    </div>

    <!-- Shift Tab -->
    <div id="tab-shift" class="content-section">
        <div class="card">
            <div class="card-title">Shift Selection Status</div>
            <div id="shiftStatus">
                <div class="alert alert-warning">Load an employee to view shift status</div>
            </div>
        </div>
    </div>

    <!-- Chat Tab -->
    <div id="tab-chat" class="content-section">
        <div class="card">
            <div class="card-title">Employee Chat</div>
            <div class="chat-container">
                <div class="chat-header" id="chatHeader">Select an employee to start chatting</div>
                <div class="chat-messages" id="chatMessages">
                    <div class="empty-state">üí¨ Load an employee to view conversation</div>
                </div>
                <div class="chat-input-area">
                    <input type="text" class="chat-input" id="chatInput" placeholder="Type message..." disabled>
                    <button class="btn btn-primary" id="btnSendChat" disabled>Send</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ID Pool Tab -->
    <div id="tab-ids" class="content-section">
        <div class="card">
            <div class="card-title">ID Pool Status</div>
            <div class="alert alert-info">
                <strong>Available:</strong> <span id="availableCount">0</span> | 
                <strong>Assigned:</strong> <span id="assignedCount">0</span> |
                <strong>Verified:</strong> <span id="verifiedCount">0</span>
            </div>
            <div class="id-pool-grid" id="idPoolGrid"></div>
        </div>
    </div>
</div>

<div class="toast-container" id="toastContainer"></div>

<script type="module">
    import { initAdminApp } from './assets/admin.js';
    
    window.switchTab = function(tabId) {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
        
        document.querySelector(`[data-tab="${tabId}"]`)?.classList.add('active');
        document.getElementById(`tab-${tabId}`)?.classList.add('active');
    };
    
    document.querySelectorAll('.tab').forEach(tab => {
        tab.addEventListener('click', () => switchTab(tab.dataset.tab));
    });
    
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initAdminApp);
    } else {
        initAdminApp();
    }
</script>

</body>
</html>
